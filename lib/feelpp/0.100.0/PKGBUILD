# Maintainer: Guillaume DOLLÃ‰ <dolle.guillaume at gmail.com>
pkgname='feelpp'
pkgver=0.100.0
_pkgrc=beta.7
pkgrel=1
pkgdesc="Feel++ a library for finite element methods - libraries"
arch=('i686' 'x86_64')
url="https://github.com/feelpp"
license=('LGPL')
depends=('ann'
         'cln'
         'eigen'
         'scotch'
         'arpack'
         'boost-libs'
         'libxml2'
         'gmsh'
         'mumps'
         'petsc'
         'metis'
         'parmetis')

makedepends=('cmake>=2.8.7')
optdepends=( 'fftw'
             'metis'
             'suitesparse'
             'slepc'
             'openturns'
             'hdf5-openmpi'
             'gperftools' )

source=($url/$pkgname/releases/download/v$pkgver-$_pkgrc/$pkgname-$pkgver-$_pkgrc.tar.gz)

prepare() {
    mkdir -p work
}

build() {
    cd work/
    cmake -DCMAKE_BUILD_TYPE=Release \
          -DCMAKE_INSTALL_PREFIX=/usr \
    ../$pkgbase-$pkgver-$_pkgrc/
    cd feel/
    make
}

package() {
    cd work/feel/
    make DESTDIR=$pkgdir install
    cd ../contrib/ginac/
    make DESTDIR=$pkgdir install
    cd ../nlopt/
    make DESTDIR=$pkgdir install
    cd ../gmsh/
    make DESTDIR=$pkgdir install
    cd ../../cmake/modules/
    make DESTDIR=$pkgdir install
    install -D -m 0644 $srcdir/$pkgbase-$pkgver-$_pkgrc/COPYING.md $pkgdir/usr/share/licenses/${pkgbase//pp}/COPYING.md
    install -D -m 0644 $srcdir/$pkgbase-$pkgver-$_pkgrc/ChangeLog  $pkgdir/usr/share/doc/${pkgbase//pp}/ChangeLog
    install -D -m 0644 $srcdir/$pkgbase-$pkgver-$_pkgrc/README.md  $pkgdir/usr/share/doc/${pkgbase//pp}/README.md
}

md5sums=('93d609832a3c706f00c4f66eb79de519')
